<!DOCTYPE html>
<!--  Last Published: Thu Aug 10 2017 07:10:06 GMT+0000 (UTC)  -->
<html data-wf-page="57fa1bc680f06b4c0306f2c3" data-wf-site="57f9f32654bcd3af639ec7f2" lang="deu">
<head>
  <meta charset="utf-8">
  <title>Amtliches Videokonferenz Portal</title>
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/amtliches-videokonferenz-portal.webflow.css" rel="stylesheet" type="text/css">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({
  google: {
    families: ["Open Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic","Roboto:300,regular,500"]
  }
});</script>
  <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);
</script>
  <link href="images/favicon.png" rel="shortcut icon" type="image/x-icon">
  <link href="images/webclip.png" rel="apple-touch-icon">
</head>
<body>
  <div class="navigation-bar w-nav" data-animation="default" data-collapse="medium" data-duration="400">
    <div class="hamburger-button w-nav-button">
      <div class="w-icon-nav-menu"></div>
    </div>
    <nav class="navigation-menu w-clearfix w-nav-menu" role="navigation"><a class="navigation-link w-nav-link" href="index.html">Home</a></nav>
    <div class="navpanel w-container"><img class="logo" src="images/Logo.png">
      <a class="brand-link w-clearfix w-nav-brand" href="index.html">
        <h1 class="brand-text">Amtliches Videokonferenz Portal</h1>
      </a>
    </div>
  </div>
  <div id="serviceHeader" class="centered hero-section herosectionservice">
    <div class="w-container" data-ix="new-interaction">
      <h1 class="hero-heading" data-ix="fade-in-bottom-page-loads"></h1>
      <div id="serviceHeaderHeadline" class="hero-subheading" data-ix="fade-in-bottom-page-loads"></div>
      <div data-ix="fade-in-bottom-page-loads"><a class="button" href="#FAQs">FAQs betrachten</a><a class="all-caps hollow-button" href="#Help_FAQs">Hilfe</a></div>
    </div>
  </div>
  
  <!-- PART 2 - Amtswahl -->
  <div id="Amtswahl">
	  <div class="accent amt section">
	    <div class="w-container">
	      <div>
	        <div class="w-form">
	          <div class="searchbar">
	            	<h5 class="plzsearch_description">Geben Sie Ihre PLZ an, um das zuständige Amt zu ermitteln ...</h5>
		            <div class="w-row">
		              <div class="w-col w-col-2 w-col-medium-2">
		                <div class="w-clearfix">
			                <img id="search-End" class="searchsubmit" height="38" src="images/if_icon-113-search-minus_314480.png" width="48">
		                	<img id="search-Start" class="searchsubmit" height="38" src="images/698627-icon-111-search-128.png" width="48">
		               </div>
	              	</div>
	              <div class="w-col w-col-10 w-col-medium-10"><input class="searchinput w-input" data-name="Servicesuche" id="search-keyword" maxlength="256" name="Servicesuche" placeholder="Suchbegriff eingeben ..."></div>
	            </div>
	          </div>
	        </div>
	        <h5 class="plzsearch_description">Trefferliste:</h5>
	        
	        <!--Trefferliste Ämter - programmatisch befüllen  -->
	        <div class="w-dyn-list">
	          <div id="success-dataFound_Aemter" class="w-dyn-items w-row">
				<!-- Programmatische Befüllung hier -->
	          </div>
	          <div id="fail-nodata_Aemter-anfrage" class="w-dyn-empty">
	            <div>Keine passenden Ämter gefunden.</div>
	          </div>
	        </div>
	        <!--Trefferliste Ämter - programmatisch befüllen ENDE -->
	      </div>
	    </div>
	  </div>
	  <div class="karte section">
	  
	  	<!-- Google Maps Placeholder - programmatically initiated -->
	    <div id="mapPlaceHolder" class="mapbox"></div>
	    <!-- Google Maps Placeholder - programmatically initiated ENDE -->
	    
	  </div>
  </div>
  <!-- ENDE PART 2 - Amtswahl -->
  
  
  <div class="help1 section" id="Help">
    <div class="w-container">
      <div class="section-title-group">
        <h2 class="centered section-heading">Wie es funktioniert</h2>
      </div>
      <div class="w-clearfix white-box whiteboxhelp"><img class="grid-image help" src="images/social-38-white.svg" width="210">
        <h3>amt wählen</h3>
        <p>Wählen Sie durch Angabe ihrer Postleitzahl aus, welches Amt für Sie zuständig ist</p>
      </div>
    </div>
  </div>
  
  <!-- PART 1 - FAQS -->
  <div id="faqs">
	  <!-- INFORMATIONEN - Programmatische Befüllung -->
	  <div class="information section" id="FAQs">
	    <div>
	      <h2>Gängige Probleme</h2>
	      <p>Bitte prüfen Sie, ob die hinterlegten Informationen ihre Frage beantworten. Sollte dies nicht der Fall sein können Sie über die Schaltfläche "INDIVIDUELLE BERATUNGSTERMIN VEREINBAREN" einen individuellen Beratungstermin vereinbaren.</p>
	    </div>
	    <div class="w-dyn-list">
	      <div id="success-dataFound-anfrage" class="w-dyn-items">
	        <div class="w-dyn-item">
	          <div id="InformationenWrapper" class="infowrapper">
	          	<!-- Programmatische Befüllung -->
	          </div>
	        </div>
	      </div>
	      <div id="fail-nodata-anfrage" class="w-dyn-empty">
	        <div>Keine FAQs zum Thema vorhanden.</div>
	      </div>
	    <!--  INFROMATIONEN ENDE -->
	   
	  </div>
	   	<a id="button-termin-vereinbaren" class="button informationenhide" data-ix="hideinfors" href="#Amtswahl">Individuellen Beratungstermin vereinbaren</a>
	  </div>
  </div>
  <!-- ENDE PART 1 - FAQS -->
  
  
  
  <div class="help2 section" id="Help_FAQs">
    <div class="w-container">
      <div class="section-title-group">
        <h2 class="centered section-heading">Wie es funktioniert</h2>
      </div>
      <div class="w-clearfix white-box whiteboxhelp"><img class="grid-image help" src="images/social-38-white.svg" width="210">
        <h3>Informationen Prüfen</h3>
        <p>Bitte prüfen Sie, ob die hinterlegten Informationen ihre Frage beantworten. Sollte dies nicht der Fall sein können Sie über die Schaltfläche "INDIVIDUELLE BERATUNGSTERMIN VEREINBAREN" einen individuellen Beratungstermin vereinbaren.</p>
      </div>
    </div>
  </div>
  <div class="footer">
    <div class="w-container">
      <div class="w-row">
        <div class="spc w-col w-col-6">
          <h5>über das portal</h5>
          <p>Das Portal versucht Bürger und Ämter einfacher in Kontakt treten zu lassen. Entstanden ist es aus einem Forschungsprojekt der Hochschule Mainz.</p>
        </div>
        <div class="spc w-col w-col-6">
          <h5>Nützliche links</h5><a class="footer-link" href="misc/weitereinformationen.html">Weitere Informationen</a><a class="footer-link" href="misc/impressum.html">Impressum</a></div>
      </div>
    </div>
  </div>
  <div class="center footer"></div>
  <script
		src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"
		type="text/javascript">
  </script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA8mYd88d3MKVqqveMpV93fkclfe32uHtY"></script>
  <script>
  
  	$().ready(function(){
	  
		var errOcc = false;
		var errOcc_Aemter = false;
		
	  	$( "#fail-nodata-anfrage" ).hide( "fast" );
		$( "#success-dataFound-anfrage" ).hide( "fast" );
		
	  	$( "#fail-nodata_Aemter-anfrage" ).hide( "fast" );
		$( "#success-dataFound_Aemter-anfrage" ).hide( "fast" );
		
		var urlParams = getUrlParams();

		$.ajax({
	    	headers: { 
	    	    "Accept": "application/json",
	        	"Content-Type": "application/json"
	    	},
		  	url: "/requestHandler/rest/request/getData/ServiceEinzeldaten/?user=AVP_Frontend&userAuth=test",
	    	type: "POST",
	    	dataType: "json",
	    	data: "{\"variables\": {\"BERATUNGSGEBIET_ID\":" + urlParams.BERATUNGSGEBIET + ", \"SERVICE_ID\":" + urlParams.ID + "}}"
		})
		  .fail(function(data){
			errOcc = true;
  		
	  		if ( console && console.log ) {
	  	  		console.log( data );
	  	  	}
		  })
		  .done(function( data ) {
				if ( console && console.log ) {
	  		    	
		  			var serviceEinzeldaten = data.RESULT[0];
	  		    	if(serviceEinzeldaten){
	  		    		if(serviceEinzeldaten.SERVICEKATEGORIE && serviceEinzeldaten.SERVICEKATEGORIE.IMAGE) {
	  		    			$("#serviceHeader").css("background-image", "url(" + serviceEinzeldaten.SERVICEKATEGORIE.IMAGE + ")");
	  		    		}
	   					if(serviceEinzeldaten.NAME){
	   						$("#serviceHeaderHeadline").text(serviceEinzeldaten.NAME);
	   					}
	   					if(serviceEinzeldaten.INFORMATIONEN){
	   						var informationen = serviceEinzeldaten.INFORMATIONEN;
	   						if(informationen && informationen.length > 0){
		   						for(info of informationen){
		   							if(info.NAME){
			  	  		  				addTemplate($( '#InformationenWrapper' ), 
			  	  		  							info.NAME, 
			  	  		  							info.ANTWORT_VORSCHAU, 
			  	  		  							info.ID);
		   							}else{
		   								errOcc = true;
		   							}
		   						}
	   						}else{
	   							errOcc = true;
	   						}
	   					}else{
	   						errOcc = true;
	   					}
	   					if(serviceEinzeldaten.ZUSTAENDIGE_AEMTER){
	   						var aemter = serviceEinzeldaten.ZUSTAENDIGE_AEMTER;
	   						if(aemter && aemter.length > 0){
		   						for(amt of aemter){
		   							if(amt.NAME){
			  	  		  				addTemplateAmt($( '#success-dataFound_Aemter' ), 
			  	  		  								amt.NAME, 
			  	  		  								amt.ADRESSE, 
			  	  		  								amt.PLZ,
			  	  		  								amt.ORT,
			  	  		  								amt.URL,
			  	  		  								amt.LOGO,
			  	  		  								"detail_aemter.html?ID=" + amt.ID + "&AMTSART_ID=" + serviceEinzeldaten.AMTSART_ID + "&SERVICE=" + urlParams.ID + "&BERATUNGSGEBIET=" + urlParams.BERATUNGSGEBIET,
			  	  		  								amt.PLZ_GEBIET_VON ,
			  	  		  								amt.PLZ_GEBIET_BIS,
			  	  		  								amt.ID);
		   							}else{
		   								errOcc_Aemter = true;
		   							}
		   						}
	   						}else{
	   							errOcc_Aemter = true;
	   						}
	   					}else{
	   						errOcc_Aemter = true;
	   					}
	  		    	}else{
	  		    		console.log( "Keine Informationen in der Datenbank gepflegt!" );
	  		    		errOcc_Aemter = true;
	  		    	}
		    	}	
		    })
		  .always(function() {
			    $.getScript("js/webflow.js", function(){
			      //Do nothing yet
			  	});
			  
	    		if(errOcc){
    	  	  		$( "#fail-nodata-anfrage" ).show( "fast" );
    				$( "#success-dataFound-anfrage" ).hide( "fast" );
	    		}else{
    	  	  		$( "#fail-nodata-anfrage" ).hide( "fast" );
    				$( "#success-dataFound-anfrage" ).show( "fast" );
	    		}
	    		
	    		if(errOcc_Aemter){
    	  	  		$( "#fail-nodata_Aemter-anfrage" ).show( "fast" );
    				$( "#success-dataFound_Aemter-anfrage" ).hide( "fast" );
	    		}else{
    	  	  		$( "#fail-nodata_Aemter-anfrage" ).hide( "fast" );
    				$( "#success-dataFound_Aemter-anfrage" ).show( "fast" );
    		}
  	  });
  	});

  	
	function addTemplate(node, name, antwort, id){
		jQuery.get('Templates/HTML-Snippets/Informationen.html', function(template) {
			   
			var filledInTemplate = template.replace("%NAME%", name);
		 	filledInTemplate = filledInTemplate.replace("%ANTWORT%", antwort);
		 	filledInTemplate = filledInTemplate.replace("%ID%", id);
			
		 	node.append(filledInTemplate);  
		});
	}
	
	function addTemplateAmt(node, name, adresse, plz, ort, url, image, link, filterVon, filterBis, id){
		jQuery.get('Templates/HTML-Snippets/Amt.html', function(template) {
			   
			var filledInTemplate = template.replace("%NAME%", name);
			filledInTemplate = filledInTemplate.replace("%NAME%", name);
			filledInTemplate = filledInTemplate.replace("%ID%", id);
		 	filledInTemplate = filledInTemplate.replace("%ADRESSE%", adresse);
		 	filledInTemplate = filledInTemplate.replace("%PLZ%", plz);
		 	filledInTemplate = filledInTemplate.replace("%ORT%", ort);
		 	filledInTemplate = filledInTemplate.replace("%ADRESSE%", adresse);
		 	filledInTemplate = filledInTemplate.replace("%PLZ%", plz);
		 	filledInTemplate = filledInTemplate.replace("%ORT%", ort);
		 	filledInTemplate = filledInTemplate.replace("%URL%", url);
		 	filledInTemplate = filledInTemplate.replace("%IMAGE%", image);
		 	filledInTemplate = filledInTemplate.replace("%LINK%", link);
		 	filledInTemplate = filledInTemplate.replace("%PLZ_GEBIET_VON%", filterVon);
		 	filledInTemplate = filledInTemplate.replace("%PLZ_GEBIET_BIS%", filterBis);
			
		 	node.append(filledInTemplate);  
		});
	}
	
	function getUrlParams(){
		var params = {};

		if (location.search) {
		    var parts = location.search.substring(1).split('&');

		    for (var i = 0; i < parts.length; i++) {
		        var nv = parts[i].split('=');
		        if (!nv[0]) continue;
		        params[nv[0]] = nv[1] || true;
		    }
		}
		
		return params;
	}
  
  
  var map;
  var marker;
  var geocode;
  
  $('#button-termin-vereinbaren').click(function(event){
	  initMap();
  });
  
   function initMap() {
  	if(!map){
  	    geocoder = new google.maps.Geocoder();
        map = new google.maps.Map(document.getElementById('mapPlaceHolder'), {
            zoom: 10,
            center: {lat: 59.325, lng: 18.070}
          });
	  }
     }
   
    function setMarker(coords){
		if(marker){
			marker.setMap(null);
		}
        marker = new google.maps.Marker({
          map: map,
          draggable: true,
          animation: google.maps.Animation.DROP,
          position: coords
        });
        marker.addListener('click', toggleBounce);
        
        map.panTo(marker.getPosition());
    }

    function toggleBounce() {
      if (marker.getAnimation() !== null) {
        marker.setAnimation(null);
      } else {
        marker.setAnimation(google.maps.Animation.BOUNCE);
      }
    }
    
    function codeAddressAndSetMarker(name, adress) {
        geocoder.geocode( { 'address': adress}, function(results, status) {
          if (status == google.maps.GeocoderStatus.OK) {
          	map.setCenter(results[0].geometry.location);
            setMarker(results[0].geometry.location)
          } else {
            console.log('Geocode was not successful for the following reason: ' + status);
          }
        });
      }
    
	$( '#search-Start' ).click(function(event){
		var searchKey = $( '#search-keyword' ).val();
		console.log(searchKey);
				
		var domList = $( "[id^=Amt_]" );
		domList.show( "slow" );
		
		if(searchKey.length > 0){
			var hitList = domList.not(function(){	
				return (
						((($(this).find('#filterPLZ_Von').text() <= searchKey) && 
					    ($(this).find('#filterPLZ_Bis').text() >= searchKey)))
					   )
			});

			hitList = hitList.filter(function(){	
				return (($(this).find('#filter_Ort').filter(":contains(" + searchKey +")").length == 0))
			});
			
			 
			
			hitList.hide( "slow" );
		}
	});
	
	$( '#search-End' ).click(function(event){
		$( '#search-keyword' ).val("");
		
		var domList = $( "[id^=Amt_]" );
		domList.show( "slow" );
	});
	
	$.expr[":"].contains = $.expr.createPseudo(function(arg) {
	    return function( elem ) {
	        return $(elem).text().toUpperCase().indexOf(arg.toUpperCase()) >= 0;
	    };
	});
	
	$('#search-keyword').bind("enterKey",function(e){
		$( '#search-Start' ).click();
	});
	$('#search-keyword').bind("escKey",function(e){
		$( '#search-End' ).click();
	});
	$('#search-keyword').keyup(function(e){
	    if(e.keyCode == 13) $(this).trigger("enterKey");
	    if(e.keyCode == 27) $(this).trigger("escKey");
	});
  </script>
  <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
</body>
</html>